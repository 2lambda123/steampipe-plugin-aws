---
title: "Table: aws_securityhub_finding_aggregator - Query AWS Security Hub Finding Aggregator using SQL"
description: "Allows users to query AWS Security Hub Finding Aggregator to gather information about the findings that are generated by the integrated third-party products and AWS services."
---

# Table: aws_securityhub_finding_aggregator - Query AWS Security Hub Finding Aggregator using SQL

The `aws_securityhub_finding_aggregator` table in Steampipe provides information about the findings that are generated by the integrated third-party products and AWS services. This table allows security analysts and DevOps engineers to query findings-specific details, including severity, resource details, and associated metadata. Users can utilize this table to gather insights on findings, such as the types of findings, the resources involved, and the severity of the findings. The schema outlines the various attributes of the findings, including the finding ARN, creation date, compliance status, and associated tags.

## Table Usage Guide

To gain a deeper understanding of the structure and metadata of the `aws_securityhub_finding_aggregator` table, you can use the `.inspect aws_securityhub_finding_aggregator` command in Steampipe.

**Key columns**:

- `arn`: The ARN of the finding. This can be used to uniquely identify each finding.
- `product_arn`: The ARN of the product that generated the finding. This can be used to filter findings by product.
- `resource_id`: The ID of the resource that the finding applies to. This can be used to filter findings by resource.

## Examples

### Basic info

```sql
select
  arn,
  finding_aggregation_region,
  region_linking_mode
from
  aws_securityhub_finding_aggregator;
```

### List finding aggregators linked to all regions

```sql
select
  arn,
  finding_aggregation_region,
  region_linking_mode
from
  aws_securityhub_finding_aggregator
where
  region_linking_mode = 'ALL_REGIONS';
```

### List regions for finding aggregators that include specific regions

```sql
select
  arn,
  region_linking_mode,
  r as linked_region
from
  aws_securityhub_finding_aggregator,
  jsonb_array_elements_text(regions) as r
where
  region_linking_mode = 'SPECIFIED_REGIONS';
```

### List regions for finding aggregators that exclude specific regions

```sql
select
  arn,
  a.name as linked_region
from
  aws_securityhub_finding_aggregator as f,
  aws_region as a,
  jsonb_array_elements_text(f.regions) as r
where
  region_linking_mode = 'ALL_REGIONS_EXCEPT_SPECIFIED'
and
  a.name <> r;
```